<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>登録完了ページ</title>
	<link rel="icon" href="image/logoIcon.png">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="サギ、ダメ、ゼッタイ！">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">
	<style>
		.d-none {
			display: none;
		}

		dialog {
			margin: auto;
			padding: 1.5rem;
			border: none;
			border-radius: 0.5rem;
			text-align: center;
		}

		dialog::backdrop {
			background-color: rgba(255, 0, 0, 0.5);
		}

		#tmk {
			width: 68vw;
			height: 68vh;
			max-width: 300px;
			max-height: 500px;
			background-size: cover;
			background-position: center center;
			background-image: url("img/character53.png");
		}

		#popup {
			margin-top: 1rem;
			padding: 0.5rem 1rem;
			border-radius: 0.4rem;
			cursor: pointer;
		}
	</style>
</head>

<body>
	<dialog>
		<form method="dialog">
			<p class="is-size-4 has-text-danger has-text-weight-bold" id="special"></p>
			<div id="tmk"></div>
			<button id="popup" onclick="location.href='./fraud.html'">はい</button>
			<button id="popup" onclick="location.href='./fraud.html'">いいえ</button>
			<form>
	</dialog>
	<!-- <body class="has-background-black"> -->
	<div id="show-later" class="d-none">
		<div id="notification" class="notification" style="position: fixed; z-index: 1; width: 100%;">
			<button id="delete" class="delete"></button>
			※ この請求はフィクションであり、実在の人物・団体とは一切関係ありません。
		</div>
	</div>
	<section class="hero is-text">
		<div class="hero-body">
			<div class="container">
				<div class="notification is-primary">
					<p>ご利用ありがとうございます。</p>
				</div>
				<h1 class="title is-size-1">登録完了</h1>
				<p class="is-size-4">お客様の会員登録が正常に完了しました。</p>
				<p class="is-size-4 has-text-danger">期限内に<span class="is-size-3 has-text-weight-bold"
						id="price"></span>を下記の口座までお振込みください。</p>
				<div class="notification is-danger">
					<p class="is-size-3 has-text-centered">
						残り
						<span id="hour">24</span>時間
						<span id="min">0</span>分
						<span id="sec">0</span>秒
					</p>
					<progress class="progress" max="100"></progress>
				</div>
				<p class="has-text-danger">お支払いの確認ができない場合は<span
						class="has-text-weight-bold">法的措置</span>をとらせていただきますのでご注意ください。
				</p>
			</div>
		</div>
	</section>
	<section class="section">
		<div class="container">
			<h2 class="title">お客様情報</h2>
			<table class="table is-striped is-fullwidth">
				<tr>
					<td>登録日時</td>
					<td id="date"></td>
				</tr>
				<tr>
					<td>端末情報</td>
					<td id="device"></td>
				</tr>
				<tr>
					<td>IPアドレス</td>
					<td id="ip"></td>
				</tr>
				<tr>
					<td>国名コード</td>
					<td id="country"></td>
				</tr>
				<tr id="unspecified_r">
					<td>都道府県</td>
					<td id="region"></td>
				</tr>
				<tr id="unspecified_c">
					<td>市区町村</td>
					<td id="city"></td>
				</tr>
				<tr>
					<td>位置情報</td>
					<td id="loc"></td>
				</tr>
			</table>
			<h2 class="title">お問合せ先</h2>
			<table class="table is-striped is-fullwidth">
				<tr>
					<td>電話番号</td>
					<td>0120-333-906</td>
				</tr>
				<tr>
					<td>メールアドレス</td>
					<td>miwainfo@dhcexample.com</td>
				</tr>
			</table>
			<h2 class="title">お振込み先</h2>
			<table class="table is-striped is-fullwidth">
				<tr>
					<td>銀行名（銀行コード）</td>
					<td>東京ルーラル銀行（1192）</td>
				</tr>
				<tr>
					<td>支店名（支店コード）</td>
					<td>葛飾支店（296）</td>
				</tr>
				<tr>
					<td>種別</td>
					<td>普通預金</td>
				</tr>
				<tr>
					<td>口座番号</td>
					<td>8421050</td>
				</tr>
			</table>
		</div>
	</section>
	<script src="https://code.jquery.com/jquery-3.6.0.slim.min.js"
		integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/platform/1.3.6/platform.min.js"></script>
	<script type="text/javascript">
		// history.pushState(null, null, location.href);
		// $(window).on('popstate', function(){
		//   history.go(1);
		// });

		let price = document.getElementById('price');
		let special = document.getElementById('special');

		// ページ読み込み時の処理
		window.addEventListener("load", () => {
			// sessionStorage の値を読み込み
			let jsonCount = sessionStorage.getItem('storage');
			// null が生成され
			count = JSON.parse(jsonCount);
			// 1 になる
			count++;

			if (count == 1) {
				jsonCount = JSON.stringify(count);
				sessionStorage.setItem('storage', jsonCount);
				price.innerHTML = ' 106,000円 ';
				special.innerHTML = 'ねえ、払って？';
			} else {
				jsonCount = JSON.stringify(count);
				sessionStorage.setItem('storage', jsonCount);
				price.innerHTML = ' 100,000,000円 ';
				special.innerHTML = 'おいコラ、払えや';
			}
		});

		let c = 6 * 60 * 60 * 4;
		setInterval(() => {
			$("#hour").text(Math.floor(c / 3600));
			$("#min").text(Math.floor((c % 3600) / 60));
			$("#sec").text(Math.floor(c % 60));
			c = c - 1;
		}, 1000);

		$("#date").text(new Date().toLocaleString("ja-JP"));
		$("#device").text(platform.description);

		const showLater = document.getElementById("show-later");
		function switchDisplay() {
			showLater.classList.remove("d-none");
		}
		setTimeout(() => {
			switchDisplay();
		}, 1000);

		$("#delete").click(() => {
			$("#notification").addClass("is-hidden");
			setTimeout(() => {
				const dialog = document.querySelector('dialog');
				dialog.showModal();
			}, 1000);
		});

		const script = document.createElement('script');
		script.src = 'https://ipinfo.io?callback=callback';
		document.body.appendChild(script);
		function callback(data) {
			$("#ip").text(data.ip);
			$("#country").text(data.country);
			$("#region").text(data.region);
			$("#city").text(data.city);
			$("#loc").text(data.loc);

			// キャリア通信の場合は恐らく都道府県と市区町村が一致するため特定不可 → 行を削除しておく
			if (data.region == data.city) {
				$("#unspecified_r").css({ 'visibility': 'collapse' });
				$("#unspecified_c").css({ 'visibility': 'collapse' });
			}

			// city: 市区町村
			// country: 国
			// hostname: ホスト名
			// ip: IPアドレス
			// loc: 位置情報
			// org: 組織名
			// postal: 郵便番号
			// readme: "https://ipinfo.io/missingauth"
			// region: 都道府県
			// timezone: "Asia/Tokyo"

		}
	</script>
</body>

</html>